# しおり検索（セマンティック検索）の使い方

## 概要

「あれ、どこに書いてあったっけ？」

専門書を読んでいると、以前読んだ内容を思い出したいけど、どのページだったか分からない…という経験はありませんか？

**しおり検索**は、しおりを付けたページの中から、自然な言葉で関連するページを見つけ出すAI検索機能です。

---

## 仕組み

### 従来のキーワード検索との違い

| 従来の検索 | しおり検索 |
|-----------|----------|
| 完全一致が必要 | 意味で検索 |
| 「ニューラルネットワーク」→ 完全一致のみ | 「深層学習の仕組み」→ 関連ページがヒット |
| 表記揺れに弱い | 同義語・関連語も対象 |

### 技術的な背景

1. しおりを付けると、AIがページ内容を要約
2. 要約をベクトル化（数値の配列に変換）
3. 検索時、クエリもベクトル化
4. ベクトル同士の類似度で関連ページを発見

---

## 使い方

### 基本の流れ

1. **読書中にしおりを付ける** - 重要なページにどんどんしおりを追加
2. **後から検索** - 「あの話どこだっけ？」と思ったら検索
3. **ページにジャンプ** - 検索結果をタップして該当ページへ

### しおりを付ける

読書中に **🔖** ボタンをタップ。

> 💡 しおりを付けると、約3分後にバックグラウンドでインデックスが作成されます。
> これはAPI無料枠を節約するためです。すぐ外しても課金されません。

### 検索を開く

読書中に **🔍** ボタンをタップ。

フローティング検索ウィンドウが表示されます。

```
┌─────────────────────────────────┐
│  ═══  しおり検索       ▼  ✕   │ ← ドラッグで移動可能
├─────────────────────────────────┤
│ 🔍 検索...              ✕ 検索 │
├─────────────────────────────────┤
│                                 │
│ p.42  技術書.pdf          85%  │ ← 検索結果
│ ニューラルネットワークの基礎... │
│                                 │
│ p.108 論文A.pdf           72%  │
│ 深層学習モデルの構造について... │
│                                 │
└─────────────────────────────────┘
```

### 検索する

1. 検索バーに自然な言葉で入力
   - 例：「勾配降下法の説明」
   - 例：「著者の主張」
   - 例：「実験結果のグラフ」

2. 「検索」ボタンをタップ（またはキーボードでEnter）

3. 関連度の高い順に最大5件の結果が表示

### 検索結果の見方

```
p.42  技術書.pdf          85%
ニューラルネットワークの基礎について解説。
活性化関数と重みの更新について...
```

- **p.42**: ページ番号
- **技術書.pdf**: PDF名
- **85%**: マッチ度（高いほど関連性が高い）
- **要約テキスト**: ページ内容の概要

### ページにジャンプ

検索結果をタップすると、該当するPDFの該当ページが開きます。

> 💡 別のPDFの検索結果をタップすると、そのPDFが自動で開きます

---

## フローティングウィンドウの操作

### ドラッグで移動

ウィンドウ上部（タイトルバー）をドラッグすると、画面上の好きな位置に移動できます。

PDFと重なって読みにくい場合に便利です。

### 最小化

**▼** ボタンをタップすると、タイトルバーだけの最小表示になります。

再度タップで元のサイズに戻ります。

### 閉じる

**✕** ボタンをタップでウィンドウを閉じます。

> 💡 **重要**: 閉じても検索結果は保持されます！
> 次に🔍をタップすると、前回の結果がそのまま表示されます。

### 結果をクリア

新しい検索をしたいときは、検索バー内の **✕** ボタンをタップ。
検索結果がクリアされ、新しいクエリを入力できます。

---

## インデックスの管理

### インデックス件数の確認

フローティングウィンドウに「○○件」と表示されます。
これはインデックスされたしおりページの総数です。

### インデックスの再構築

検索結果がおかしい場合は、インデックスを再構築できます：

1. 検索ウィンドウの **⋯** メニューをタップ
2. 「インデックス再構築」を選択
3. すべてのしおりページを再解析

---

## 活用シーン

### 論文を読み返すとき

「確か著者がこの手法の限界について言及していた気がする…」

→ 「手法の限界点」で検索

### 複数の本を横断して探すとき

「勾配消失問題について、どの本に詳しく書いてあったっけ？」

→ 「勾配消失問題」で検索 → 複数のPDFから結果が表示

### 試験勉強の復習

「この概念、前に読んだな…」

→ 概念名で検索 → 該当ページにジャンプして復習

---

## Tips

### 効果的なしおりの付け方

- **重要な概念の説明ページ** にしおり
- **図表があるページ** にしおり（図表も要約に含まれる）
- **後で見返したいページ** にしおり

### 検索のコツ

- **完全一致を狙わない**: 「ニューラルネットワークの定義」より「深層学習の基礎」の方がヒットしやすいことも
- **自然な言葉で**: 「勾配降下法」より「パラメータの最適化方法」でもOK
- **短すぎない**: 「学習」より「機械学習の学習プロセス」の方が精度が高い

### PDF内検索との使い分け

| しおり検索 | PDF内検索 |
|-----------|----------|
| 概念・内容で探す | 特定の単語を探す |
| 複数PDF横断 | 1つのPDF内 |
| しおりページのみ | 全ページ対象 |

**PDF内検索**は🔍ボタンを**長押し**で開けます。
