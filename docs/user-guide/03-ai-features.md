# AI機能の使い方

## 概要

PDF ReaderはGoogle Gemini AIを搭載。ページの翻訳、質問への回答、音声読み上げ、論文全体の要約ができます。

---

## 事前準備：APIキーの設定

AI機能を使うには、Google AI StudioでAPIキーを取得する必要があります。

### APIキーの取得方法

1. [Google AI Studio](https://aistudio.google.com/) にアクセス
2. Googleアカウントでログイン
3. 「Get API Key」→「Create API Key」をクリック
4. 生成されたAPIキーをコピー

### アプリへの設定

1. ライブラリ画面で左上の **⚙️** をタップ
2. 「Gemini API Key」の欄にキーをペースト
3. 自動で保存されます

> 💡 APIキーは端末内のKeychainに安全に保存されます

### 無料枠について

Google Gemini APIには無料枠があります：
- **1分あたり15リクエスト**
- **1日あたり1,500リクエスト**

通常の使用では十分な量です。

---

## AI機能メニュー

読書中に **✨AI解析** ボタンをタップすると、以下のメニューが表示されます：

```
┌─────────────────────────┐
│ 🔊 音声読み上げ         │
│ 🇯🇵 日本語に翻訳        │
│ 💬 このページに質問...   │
│ ──────────────────      │
│ 📄 論文を要約（全体）   │
└─────────────────────────┘
```

---

## 🔊 音声読み上げ

ページ内容を音声で読み上げます。目を休めながら学習したいときに便利。

### 使い方

1. **✨AI解析** → **音声読み上げ** をタップ
2. AIがページをOCRしてテキストを抽出
3. 自動で読み上げが開始

### 読み上げ中の操作

読み上げ中はナビバーにコントロールが表示されます：

```
[ ⏸ 一時停止 ] [ ⏹ 停止 ]
```

- **⏸**: 一時停止/再開
- **⏹**: 読み上げを停止

### 音声品質を上げるには

iPadの設定から「拡張音声」をダウンロードすると、より自然な読み上げになります：

1. **設定** → **アクセシビリティ** → **読み上げコンテンツ**
2. **声** → **日本語** をタップ
3. **Kyoko（拡張）** をダウンロード

---

## 🇯🇵 日本語に翻訳

英語の論文や技術書を日本語に翻訳します。

### 使い方

1. 翻訳したいページを開く
2. **✨AI解析** → **日本語に翻訳** をタップ
3. 翻訳結果がモーダルで表示

### 翻訳結果の画面

```
┌─────────────────────────────────┐
│ 共有          解析結果     閉じる │
├─────────────────────────────────┤
│ 💡 AI回答                       │
│ ┌─────────────────────────────┐ │
│ │ （翻訳されたテキスト）      │ │
│ └─────────────────────────────┘ │
│                                 │
│ 📄 読み取ったテキスト            │
│ （元の英文）                    │
└─────────────────────────────────┘
```

- **共有**: 翻訳結果をメモアプリなどに送れます
- テキストは長押しで選択・コピー可能

---

## 💬 このページに質問

ページ内容について自由に質問できます。

### 使い方

1. **✨AI解析** → **このページに質問...** をタップ
2. 質問を入力（例：「この式の意味は？」）
3. 「送信」をタップ
4. AIが回答を生成

### 活用例

- 「この図が示していることを説明して」
- 「この用語の定義は？」
- 「この証明のポイントを教えて」
- 「具体例を挙げて説明して」

---

## 📄 論文を要約（全体）

論文全体を解析し、要約ページ付きのPDFを生成します。

### 使い方

1. 論文PDFを開く
2. **✨AI解析** → **論文を要約（全体）** をタップ
3. 確認ダイアログで「要約する」をタップ
4. 処理完了を待つ（進捗バー表示）

### 処理の流れ

```
準備中... → ページ1/30 OCR中 → 要約生成中... → 完了！
```

### 生成される要約PDF

要約PDFには以下が含まれます：

1. **1ページ目**: AI生成の要約
   - 論文タイトル
   - 著者情報
   - 主要な発見・結論
   - 方法論の概要

2. **2ページ目以降**: 元の論文ページ

### 保存先

要約PDFは自動的に **「要約」本棚** に保存されます。

### 制限事項

- 50ページ以下の論文に対応
- 処理には数分かかる場合があります
- ネットワーク接続が必要

---

## 読書履歴

AI解析の結果は自動的に読書履歴に保存されます。

### 履歴の確認方法

1. ライブラリ画面で **📝** ボタンをタップ
2. 過去の解析結果が一覧表示

### 履歴に保存される情報

- PDF名
- ページ番号
- AIの回答（要約・翻訳など）
- 元のOCRテキスト
- 日時

---

## Tips

### 見開き表示でのAI解析

見開き表示中にAI解析すると、**両ページをまとめて** 解析します。
論文の図と本文が別ページにある場合に便利です。

### APIエラーが出たら

- APIキーが正しく設定されているか確認
- ネットワーク接続を確認
- 無料枠の上限に達していないか確認（1分15回まで）
